# タスク完了時のチェックリスト

このファイルは、コード変更のタスクを完了する際に実行すべき項目をまとめたものです。

## 必須チェック項目

### 1. コード生成の実行

Freezed、Riverpod、JSONシリアライゼーションのコード生成を実行:

```bash
task build
```

または、ウォッチモードを使用している場合は自動生成されます:
```bash
task watch
```

**対象**: 以下のアノテーションを使用したファイル
- `@freezed`
- `@riverpod`
- `@JsonSerializable()`

### 2. 静的解析・Lint

コードの静的解析を実行し、エラーや警告がないことを確認:

```bash
task analyze
```

または直接実行:
```bash
flutter analyze ./lib/ ./test/
```

**確認ポイント**:
- エラーが0件であること
- 警告は可能な限り解消すること
- `// ignore:` を使う場合は理由をコメント

### 3. フォーマット（オプション）

IDEのフォーマッタが有効な場合は自動実行されますが、手動でも実行可能:

```bash
dart format lib/ test/
```

### 4. テストの実行（推奨）

変更に関連するテストを実行:

```bash
# 全テスト実行
task test

# カバレッジレポート付き
task test-with-coverage
```

**テスト方針**:
- ViewModel、UseCaseの変更時はテストを更新・追加
- 新機能追加時はテストも追加することを推奨
- バグ修正時は再現テストを追加することを推奨

### 5. 動作確認

実機またはシミュレータで動作確認:

```bash
task run
```

**確認項目**:
- 実装した機能が正常に動作すること
- 既存機能が壊れていないこと（リグレッションテスト）
- UIに変更がある場合、Before/Afterのスクリーンショット撮影

### 6. Git操作

#### 変更内容の確認
```bash
# 変更ファイル一覧
git status

# 変更内容の差分
git diff
```

#### コミット
```bash
# ステージング
git add .

# コミット（適切なメッセージで）
git commit -m "機能名: 説明 (#Issue番号)"
```

**コミットメッセージ形式**:
- 追加: `Add 機能名` / `機能名を追加`
- 更新: `Update 対象` / `対象を更新`
- 修正: `Fix 問題` / `問題を修正`
- リファクタリング: `Refactor 対象`

#### プッシュ
```bash
git push origin <ブランチ名>
```

### 7. Pull Request作成

GitHubでPull Requestを作成:

**必須項目**:
- ✅ タイトル（5文字以上）
- ✅ 説明（10文字以上、テンプレート使用）
- ✅ Reviewer設定
- ✅ Assignee設定（自分自身）
- ✅ Milestone設定

**テンプレート記入項目**:
- [ ] 概要
- [ ] やったこと
- [ ] 関連するIssue（`Close #番号`）
- [ ] 確認したこと
- [ ] UI差分（該当する場合）
- [ ] コメント（レビュアーへ）

## 状況別チェックリスト

### 新機能追加の場合

1. ✅ アーキテクチャパターン（MVVM + UseCase）に従っているか
2. ✅ Feature構造に配置されているか
3. ✅ Riverpod、Freezedを適切に使用しているか
4. ✅ DRY、SOLID原則に従っているか
5. ✅ テストを追加したか（推奨）
6. ✅ UIスクリーンショット（Before/After）を準備したか

### バグ修正の場合

1. ✅ 根本原因を特定したか
2. ✅ 同様の問題が他にないか確認したか
3. ✅ 修正内容が最小限か（過度なリファクタリングを避ける）
4. ✅ 再現テストを追加したか（推奨）

### リファクタリングの場合

1. ✅ 既存機能が壊れていないか
2. ✅ テストが全てパスするか
3. ✅ コード品質が向上したか（可読性、保守性）
4. ✅ 変更範囲が最小限か

### ドキュメント更新の場合

1. ✅ マークダウン形式が正しいか
2. ✅ 内容が最新の状態を反映しているか
3. ✅ リンクが正しく動作するか

## CI/CDパイプライン

PR作成後、自動的に以下のCIが実行されます:

- ✅ 静的解析（`flutter analyze`）
- ✅ テスト（`flutter test`）
- ✅ ビルド確認

**マージ前に必ず全てのCIがパスすることを確認**

## Dangerによる自動チェック

以下の項目がDangerによって自動チェックされます:

- ✅ PRタイトルが5文字以上
- ✅ PR説明が10文字以上
- ✅ Reviewerが設定されている
- ✅ Assigneeが設定されている
- ✅ Milestoneが設定されている

## オプション項目

### パフォーマンスチェック（該当する場合）

- 重い処理がメインスレッドをブロックしていないか
- 不要なWidget再構築が発生していないか
- メモリリークがないか

### アクセシビリティ（該当する場合）

- スクリーンリーダー対応
- 十分なタップ領域
- 色のコントラスト

### セキュリティ（該当する場合）

- 機密情報がコードに含まれていないか
- `.env` ファイルがコミットされていないか
- API キーが適切に管理されているか

## トラブルシューティング

### コード生成が失敗する場合

```bash
# クリーンアップ
task clean

# 依存関係再インストール
task install

# 再度ビルド
task build
```

### 静的解析エラーが解消できない場合

```bash
# 詳細なエラー情報を確認
flutter analyze --verbose
```

### テストが失敗する場合

```bash
# 特定のテストファイルを実行
flutter test test/path/to/test_file.dart

# 詳細な出力
flutter test --reporter expanded
```

---

**重要**: 
- 全てのチェック項目を完了してからPRをマージ
- 不明点があればチームメンバーに相談
- 焦らず丁寧に、品質を優先

© 2025 Dotto
